<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../bower_components/app-route/app-location.html">
<link rel="import" href="../../../../bower_components/iron-location/iron-location.html">
<link rel="import" href="../../../../bower_components/app-route/app-route.html">
<link rel="import" href="../../../../bower_components/app-route/app-route-converter.html">
<link rel="import" href="../../../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../sections/home-section.html">
<link rel="import" href="../sections/about-section.html">
<link rel="import" href="../sections/article-section.html">
<link rel="import" href="../sections/not-found.html">

<dom-module id="content-pages">
    <template>
        <link rel="stylesheet" href="../../css/content-pages.css">
        <main>
            <iron-location hash="{{path}}" use-hash-as-path></iron-location>
            <app-route-converter
                path="{{computedPath}}"
                query-params="{}"
                route="{{route}}"></app-route-converter>
            <app-route
                route="{{route}}"
                pattern="/:page"
                data="{{data}}"
                tail="{{tail}}"></app-route>
            <app-route
                route="{{tail}}"
                pattern="/:article"
                data="{{article}}"></app-route>

            <iron-pages
                selected="{{page}}"
                attr-for-selected="data-page"
                fallback-selection="not-found">
                    <home-section data-page="" query-string="{{params}}"></home-section>
                    <article-section data-page="blog" article="{{article.article}}"></article-section>
                    <about-section data-page="about"></about-section>
                    <not-found data-page="not-found"></not-found>
            </iron-pages>
        </main>

    </template>
    <script>
        Polymer({
            is: "content-pages",
            properties: {
                page: {
                    type: String,
                    computed: '_computePage(data)'
                },
                path: {
                    type: String,
                    value: '',
                    observer: '_onPathChange'
                },
                computedPath: {
                    type: String,
                    value: ''
                },
                params: {
                    type: String,
                    value: ''
                }
            },
            _computePage: function (data) {
                return typeof data.page !== 'undefined' ? data.page : '';
            },
            _onPathChange: function () {
                let arr = this.path.split('?')
                this.computedPath = arr[0] || '';
                this.params = arr[1] || '';
            }
        });
    </script>
</dom-module>
